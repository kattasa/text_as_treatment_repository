### A New Experimental Design for Text as Treatment
This repository contains files and scripts for reproducing results from our paper introducing a new experimental design for answering causal questions with text as treatment. This repository is split into 3 components. The main directory contains the files `./qlevel_results.csv` and `./rating_data.csv` that contain data from our survey experiment. We analyze this original data in `real_data_analysis_final.R` where we perform data filtering, conduct regressions to extract ground-truth treatment effects, and perform the analysis for the Detailed Analysis section of the paper. After running `real_data_analysis_final.R`, we also run the `./data_preprocessing.py` script in order to generate our semi-synthetic simulation data.

The second component deals with the `causal_text` subdirectory, which contains scripts needed to run the `TextCause` algorithm in the simulations. This subdirectory requires first running the `./data_preprocessing.py` python file in order to generate the data we will use for simulations. We can then run the `causal_text_slurm.sh` script to run parallelized simulation jobs using SLURM (please make sure to change the local directory to be `./causal-text/src/`). The `main.py` script implements the `TextCause` algorithm, as well as the IPW, OR, and AIPW benchmarks. 

The last component deals with the `TI_estimator` subdirectory, which contains scripts needed to run the `TI Estimator` algorithm in the simulations. This subdirectory also requires first runnning the `./data_preprocessing.py` python file in order to generate the data we will use for simulations. We can then run the `causal_text_slurm.sh` script to run parallelized simulation jobs using SLURM (please make sure to change the local directory to be `./TI_estimator/src/`). The `main.py` script implements the `TI_estimator` algorithm.

We then aggregate simulation results in the `sim_plotting.R` script. This will combine all results for the "Benchmarking Text-As-Treatment Estimators" section of the paper to produce Figure 1 and Table 1.